<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Doom 1998 Browser Demo</title>
<style>
body{margin:0; overflow:hidden; background:black; color:white; font-family:sans-serif;}
canvas{display:block;}
#info{position:absolute;top:10px;left:10px;color:white;font-size:18px;}
</style>
</head>
<body>
<div id="info">Use WASD to move, mouse to look, left click to shoot</div>
<canvas id="gameCanvas" width="800" height="600"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
let width = canvas.width, height = canvas.height;

let player = {x:100, y:100, angle:0, speed:0, bullets:[]};
let keys = {};

document.addEventListener("keydown", e => keys[e.key] = true);
document.addEventListener("keyup", e => keys[e.key] = false);
canvas.addEventListener("click", shoot);

function shoot(){
  player.bullets.push({x:player.x, y:player.y, angle:player.angle});
}

// Simple map: 0 = empty, 1 = wall
const map = [
  [1,1,1,1,1,1,1,1,1,1],
  [1,0,0,0,0,0,0,0,0,1],
  [1,0,0,0,0,0,0,0,0,1],
  [1,0,0,0,0,0,0,0,0,1],
  [1,0,0,0,0,0,0,0,0,1],
  [1,0,0,0,0,0,0,0,0,1],
  [1,0,0,0,0,0,0,0,0,1],
  [1,1,1,1,1,1,1,1,1,1]
];

const enemies = [
  {x:400, y:200, size:20, hp:3},
  {x:600, y:400, size:20, hp:3}
];

function update(){
  // player movement
  if(keys["w"]) player.y -= 2;
  if(keys["s"]) player.y += 2;
  if(keys["a"]) player.x -= 2;
  if(keys["d"]) player.x += 2;
  
  // bullets
  player.bullets.forEach((b,i)=>{
    b.x += Math.cos(b.angle)*10;
    b.y += Math.sin(b.angle)*10;
    enemies.forEach((e,ei)=>{
      if(Math.abs(b.x-e.x)<e.size && Math.abs(b.y-e.y)<e.size){
        e.hp--;
        player.bullets.splice(i,1);
        if(e.hp<=0) enemies.splice(ei,1);
      }
    });
  });
}

function draw(){
  ctx.fillStyle="black";
  ctx.fillRect(0,0,width,height);

  // Draw walls
  for(let r=0;r<map.length;r++){
    for(let c=0;c<map[r].length;c++){
      if(map[r][c]===1){
        ctx.fillStyle="#400000"; // blood red wall
        ctx.fillRect(c*80,r*75,80,75);
      }
    }
  }

  // Draw player gun
  ctx.fillStyle="gray";
  ctx.fillRect(width/2-20,height-100,40,100);

  // Draw enemies
  enemies.forEach(e=>{
    ctx.fillStyle="green";
    ctx.fillRect(e.x-10,e.y-10,20,20);
  });

  // Draw bullets
  ctx.fillStyle="yellow";
  player.bullets.forEach(b=>{
    ctx.beginPath();
    ctx.arc(b.x,b.y,4,0,Math.PI*2);
    ctx.fill();
  });
}

function gameLoop(){
  update();
  draw();
  requestAnimationFrame(gameLoop);
}

canvas.addEventListener("mousemove", e=>{
  let rect = canvas.getBoundingClientRect();
  let dx = e.clientX - rect.left - width/2;
  let dy = e.clientY - rect.top - height/2;
  player.angle = Math.atan2(dy, dx);
});

gameLoop();
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Galaga Rocket Game with Custom Ship</title>
<style>
  body { margin: 0; background: black; overflow: hidden; font-family: sans-serif; color: white; }
  canvas { display: block; margin: auto; background: black; }
  #score { position: absolute; top: 10px; left: 10px; font-size: 24px; }
</style>
</head>
<body>
<div id="score">Score: 0 | Level: 1</div>
<canvas id="gameCanvas" width="600" height="800"></canvas>
<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

// Key input
let keys = {};
document.addEventListener("keydown", (e) => keys[e.key.toLowerCase()] = true);
document.addEventListener("keyup", (e) => keys[e.key.toLowerCase()] = false);

// Load player image
const playerImg = new Image();
playerImg.src = "/mnt/data/077ec56b-0492-4711-9cd6-f0907a2b59ad.png"; // your ship image

// Player rocket
const player = {
  x: canvas.width/2 - 32,
  y: canvas.height - 80,
  width: 64,
  height: 64,
  speed: 6,
  bullets: [],
  shootCooldown: 0,
  shield: 0
};

// Player bullets
function shoot() {
  if(player.shootCooldown <= 0){
    player.bullets.push({x: player.x + player.width/2 - 3, y: player.y, width: 6, height: 12, color: "yellow", dy: -10});
    player.shootCooldown = 15;
  }
}

// Enemy setup
let enemies = [];
let enemyRows = 3;
let enemyCols = 6;
let level = 1;
let score = 0;

function createEnemies() {
  enemies = [];
  for(let r=0;r<enemyRows;r++){
    for(let c=0;c<enemyCols;c++){
      enemies.push({
        x: 60 + c*80,
        y: 60 + r*60,
        width: 40,
        height: 40,
        color: "red",
        dx: 1 + 0.2*level,
        bullets: [],
        shootChance: 0.005 + 0.002*level
      });
    }
  }
}

// Enemy bullets
let enemyBullets = [];

// Create first enemies
createEnemies();

// Game loop
function update() {
  // Move player with WASD
  if(keys["a"] && player.x > 0) player.x -= player.speed;
  if(keys["d"] && player.x + player.width < canvas.width) player.x += player.speed;
  if(keys["w"] && player.y > 0) player.y -= player.speed;
  if(keys["s"] && player.y + player.height < canvas.height) player.y += player.speed;
  if(keys[" "]) shoot();
  if(player.shootCooldown > 0) player.shootCooldown--;

  // Move player bullets
  player.bullets.forEach((b,i) => {
    b.y += b.dy;
    if(b.y + b.height < 0) player.bullets.splice(i,1);
  });

  // Move enemies
  let reverse = false;
  enemies.forEach(e => {
    e.x += e.dx;
    if(e.x + e.width > canvas.width || e.x < 0) reverse = true;

    // Enemy shooting
    if(Math.random() < e.shootChance){
      enemyBullets.push({x: e.x + e.width/2 - 3, y: e.y + e.height, width: 6, height: 12, color: "orange", dy: 5});
    }
  });
  if(reverse){
    enemies.forEach(e => {
      e.dx *= -1;
      e.y += 20;
    });
  }

  // Move enemy bullets
  enemyBullets.forEach((b,i)=>{
    b.y += b.dy;
    if(b.y > canvas.height) enemyBullets.splice(i,1);
  });

  // Collisions: player bullets vs enemies
  player.bullets.forEach((b,bi)=>{
    enemies.forEach((e,ei)=>{
      if(b.x < e.x + e.width && b.x + b.width > e.x &&
         b.y < e.y + e.height && b.y + b.height > e.y){
        player.bullets.splice(bi,1);
        enemies.splice(ei,1);
        score += 10;
      }
    });
  });

  // Collisions: enemy bullets vs player
  enemyBullets.forEach((b,i)=>{
    if(b.x < player.x + player.width && b.x + b.width > player.x &&
       b.y < player.y + player.height && b.y + b.height > player.y){
      if(player.shield && player.shield > 0){
        player.shield--;
        enemyBullets.splice(i,1);
      } else {
        alert("Game Over! Score: "+score);
        resetGame();
      }
    }
  });

  // Level up
  if(enemies.length === 0){
    level++;
    enemyRows = Math.min(5, enemyRows + 1);
    createEnemies();
  }

  // Update score display
  document.getElementById("score").innerText = `Score: ${score} | Level: ${level}`;
}

// Drawing
function draw() {
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Draw player image
  ctx.drawImage(playerImg, player.x, player.y, player.width, player.height);

  // Draw player bullets
  player.bullets.forEach(b=>{
    ctx.fillStyle = b.color;
    ctx.fillRect(b.x,b.y,b.width,b.height);
  });

  // Draw enemies
  enemies.forEach(e=>{
    ctx.fillStyle = e.color;
    ctx.fillRect(e.x,e.y,e.width,e.height);
  });

  // Draw enemy bullets
  enemyBullets.forEach(b=>{
    ctx.fillStyle = b.color;
    ctx.fillRect(b.x,b.y,b.width,b.height);
  });
}

// Reset game
function resetGame(){
  player.x = canvas.width/2 - 32;
  player.y = canvas.height - 80;
  player.bullets = [];
  enemyBullets = [];
  score = 0;
  level = 1;
  enemyRows = 3;
  createEnemies();
}

// Main loop
function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}

loop();
</script>
</body>
</html>
